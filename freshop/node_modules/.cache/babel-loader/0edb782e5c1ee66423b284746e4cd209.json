{"ast":null,"code":"import { useState, useEffect } from 'react';\nimport History from './History';\nimport axios from 'axios';\nexport default (() => {\n  const [addUser, setAddUser] = useState({\n    address: \"\",\n    email: \"\",\n    mobileNumber: \"\",\n    password: \"\",\n    role: \"\",\n    userName: \"\",\n    status: \"\"\n  });\n  const [role, setRole] = useState(\"\");\n  const [mobileNum, setMobileNum] = useState(\"\");\n  const [userDetails, setUserDetails] = useState({});\n  const [pid, setPid] = useState();\n  const [description, setDescription] = useState(\"\");\n  const [title, setTitel] = useState(\"\");\n  const [catagory, setCatagory] = useState(\"\");\n  const [src, setSrc] = useState(\"\");\n  const [price, setPrice] = useState();\n  const [useName, setUserName] = useState(\"\");\n  const [newUser, setNewUser] = useState({\n    email: \"\",\n    password: \"\"\n  });\n  const [address, setAddress] = useState(\"\");\n  const [products, setProducts] = useState([]);\n  const [filteredProducts, setfilteredProducts] = useState([]);\n  const [cartItems, setCartItems] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [usrLogin, setUsr_Login] = useState(\"\");\n  const [pwdLogin, setPwd_Login] = useState(\"\");\n  const [cnfPwdLogin, setCnfPwd_Login] = useState(\"\");\n  const [licence, setLicence] = useState(\"\");\n  const [guestCart, setGuestCart] = useState([]);\n  const [user, setUser] = useState({\n    userId: 0,\n    email: \"\"\n  });\n  const [isStatusChange, setIsStatusChange] = useState(false);\n  const [orders, setOrders] = useState([]);\n  const [env] = useState('sandbox');\n  const [isSupplier, setIsSupplier] = useState(false);\n  const [adminUser, setAdminUser] = useState([]);\n  const [currency] = useState('USD');\n  const [supplerAdded, setSupplierAdded] = useState(false);\n  const [updatableUser, setUpdatableUser] = useState({});\n  const [userStatus, setUserStatus] = useState({\n    status: \"pending\"\n  });\n  const [newProduct, setNewProduct] = useState({});\n  const [SupplierData, setSupplierData] = useState({});\n  const [allSuppliers, setAllSuppliers] = useState([]);\n  const [lastName, setLastName] = useState(\"\");\n  const [client] = useState({\n    sandbox: 'ATKphVPUKrAFnWXr042hYQsynmg9U_UUeudlf1RjYkyKf3rsf5s3IE-H1QZWn8ziKEZzq5WH4TRalZR_',\n    production: 'YOUR-PRODUCTION-APP-ID'\n  }); //Products\n\n  useEffect(() => {\n    axios.get(\"http://localhost:8080/Products\").then(resp => {\n      setProducts(resp.data);\n      setfilteredProducts(resp.data);\n    }).catch(e => {\n      console.log(e);\n    });\n  }, []);\n  useEffect(() => {\n    axios.get(\"http://localhost:8080/Roles\").then(resp => {\n      setAdminUser(resp.data);\n    }).catch(e => {\n      console.log(e);\n    });\n  }, []);\n  useEffect(() => {\n    axios.get(\"http://localhost:8080/SuppliedProduct\").then(resp => {\n      if (resp) {\n        setAllSuppliers(resp.data);\n      }\n    }).catch(e => {\n      console.log(e);\n    });\n  }, []);\n  useEffect(() => {\n    let newUserData = localStorage.getItem(\"user\");\n\n    if (newUserData != null) {\n      //alert(\"here\")\n      const setData = JSON.parse(newUserData);\n      setUser({\n        userId: setData.userId,\n        email: setData.email\n      });\n      setUserDetails({\n        userId: setData.userId,\n        email: setData.email,\n        userName: setData.userName,\n        role: setData.role,\n        address: setData.address,\n        status: setData.status\n      });\n      let newCart = localStorage.getItem(setData.userId + \"cart\");\n\n      if (newCart != null) {\n        const setCart = JSON.parse(newCart);\n        setCartItems(setCart);\n      }\n\n      if (userDetails.role === \"Seller\") {\n        let supplierNewData = localStorage.getItem(\"supplier\" + userDetails.userId);\n\n        if (supplierNewData != null) {\n          const setNewSup = JSON.parse(supplierNewData);\n          setSupplierData({\n            sid: setNewSup.sid,\n            address: setNewSup.address,\n            ln: setNewSup.ln,\n            supplierFirstName: setNewSup.supplierFirstName,\n            supplierLastName: setNewSup.supplierLastName,\n            status: setNewSup.status\n          });\n        }\n      }\n    }\n  }, [isStatusChange]);\n  useEffect(() => {\n    if (userDetails.role === \"Seller\") {\n      if (SupplierData.sid != undefined) {\n        History.push(\"/Shop/Supplier\");\n      } else {\n        History.push(\"/Shop/SupplierLogin\");\n      }\n    }\n  }, [isSupplier, SupplierData]); //Search \n\n  useEffect(() => {\n    setfilteredProducts([...products].filter(product => {\n      return product.title.toLowerCase().includes(search.toLowerCase());\n    }));\n    return () => {};\n  }, [search, products]);\n  useEffect(() => {\n    if (role === \"customer\") {\n      setAddUser({ ...addUser,\n        role: role,\n        status: \"varified\"\n      });\n    } else if (role === \"admin\") {\n      setAddUser({ ...addUser,\n        role: role,\n        status: \"pending\"\n      });\n    } else if (role === \"Seller\") {\n      setAddUser({ ...addUser,\n        role: role,\n        status: \"pending\"\n      });\n    }\n  }, [role]);\n  useEffect(() => {\n    if (user.email === null) {\n      setGuestCart(cartItems);\n    }\n  }, [cartItems, user.email]);\n  useEffect(() => {\n    if (updatableUser.userId !== 0) {\n      axios.put(\"http://localhost:8080/UpdateUser\", updatableUser).then(val => {\n        console.log(val);\n      }).catch(e => {\n        console.log(e);\n      });\n    }\n  }, [userStatus]);\n  useEffect(() => {\n    if (userDetails.role === \"Seller\") {\n      History.push(\"/Shop/Supplier\");\n    }\n  }, [supplerAdded]);\n  useEffect(() => {\n    const cartItem = cartItems; // cartItem.map((data)=>alert(data.title))\n\n    let productAlreadyInCart = false;\n\n    if (newProduct.pid != undefined) {\n      cartItem.forEach(item => {\n        if (item.pid === newProduct.pid) {\n          productAlreadyInCart = true;\n          item.count++;\n        }\n      });\n\n      if (!productAlreadyInCart) {\n        cartItem.push({ ...newProduct,\n          count: 1\n        });\n      }\n\n      setCartItems([...cartItem]);\n\n      if (user.userId != 0) {\n        localStorage.setItem(user.userId + \"cart\", JSON.stringify(cartItem));\n      }\n    }\n  }, [newProduct]);\n\n  let resultFilter = (temp1, temp2) => {\n    return temp1.filter(temp1 => !temp2.some(temp2 => temp1.id === temp2.id));\n  };\n\n  return {\n    allSuppliers: allSuppliers,\n    filteredProducts: filteredProducts,\n    cartItems: cartItems,\n    search: search,\n    orders: orders,\n    env: env,\n    currency: currency,\n    client: client,\n    userDetail: userDetails,\n    adminUserData: adminUser,\n    SupplierData: SupplierData,\n    changeLastName: value => {\n      setLastName(value);\n    },\n    changeLicence: value => {\n      setLicence(value);\n    },\n    changePid: value => {\n      setPid(value);\n    },\n    changeTitle: value => {\n      setTitel(value);\n    },\n    changeDescription: value => {\n      setDescription(value);\n    },\n    changeCatagory: value => {\n      setCatagory(value);\n    },\n    changePrice: value => {\n      setPrice(value);\n    },\n    changeSrc: value => {\n      setSrc(value);\n    },\n    addProduct: e => {\n      let newProd = {\n        sid: userDetails.userId,\n        pid: pid,\n        title: title,\n        description: description,\n        catagory: catagory,\n        src: src,\n        price: price,\n        status: \"pendingF\"\n      };\n      axios.post(\"http://localhost:8080/AddSuppliedProduct\", newProd).then(resp => {\n        if (resp) {\n          alert(\"product added successfully\");\n        }\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    finalCheckout: e => {\n      e.preventDefault();\n      cartItems.map(item => {\n        let cartData = {\n          orderId: \"AX\" + userDetails.userId + \"Ab\",\n          title: item.title,\n          amount: item.price,\n          price: item.price\n        };\n        axios.post(\"http://localhost:8080/AddOrder\", cartData).then(resp => {\n          if (resp) {\n            alert(\"order successful\");\n            localStorage.removeItem(\"supplier\" + userDetails.userId);\n          }\n        });\n      });\n    },\n    onAddCart: product => {\n      setNewProduct(product);\n    },\n    handleSearch: value => {\n      setSearch(value);\n    },\n    handleChangeSort: sort => {\n      if (sort !== '') {\n        const updated = [...products].sort((a, b) => {\n          return sort === \"lowest\" ? a.price > b.price ? 1 : -1 : a.price < b.price ? 1 : -1;\n        });\n        setfilteredProducts(updated);\n      } else {\n        const updated = [...products].sort((a, b) => {\n          return a.id < b.id ? 1 : -1;\n        });\n        setfilteredProducts(updated);\n      }\n    },\n    onRemoveCart: removeItem => {\n      const update = [...cartItems].filter(item => {\n        if (item.pid === removeItem.pid && removeItem.count <= 1) return false;else {\n          if (item.pid === removeItem.pid && removeItem.count > 1) item.count--;\n          return true;\n        }\n      });\n      setCartItems(update);\n    },\n    addSupplier: e => {\n      e.preventDefault();\n      let newSupplier = {\n        sid: userDetails.userId,\n        address: userDetails.address,\n        ln: licence,\n        status: \"pending\",\n        supplierFirstName: userDetails.userName,\n        supplierLastName: lastName\n      };\n      axios.post(\"http://localhost:8080/AddSupplier\", newSupplier).then(resp => {\n        if (resp) {\n          setSupplierAdded(true);\n        }\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    userStatus: (value, item) => {\n      // alert(item.userName)\n      setUserStatus({\n        status: value\n      });\n      setUpdatableUser(item);\n    },\n    changeRole: value => {\n      setRole(value);\n    },\n    userMobileNumChange: value => {\n      setMobileNum(value);\n      setAddUser({ ...addUser,\n        mobileNumber: value\n      });\n    },\n    userNameChange: value => {\n      setUserName(value);\n      setAddUser({ ...addUser,\n        userName: value\n      });\n    },\n    userLoginChange: value => {\n      setUsr_Login(value);\n      setNewUser({ ...newUser,\n        email: value\n      });\n      setAddUser({ ...addUser,\n        email: value\n      });\n    },\n    pwdLoginChange: value => {\n      setPwd_Login(value);\n      setNewUser({ ...newUser,\n        password: value\n      });\n      setAddUser({ ...addUser,\n        password: value\n      });\n    },\n    cnfPwdLoginChange: value => {\n      setCnfPwd_Login(value);\n    },\n    buy: value => {\n      History.push('/Shop/' + value);\n    },\n    addressChange: value => {\n      setAddress(value);\n      setAddUser({ ...addUser,\n        address: value\n      });\n    },\n    login: e => {\n      e.preventDefault();\n      console.log(newUser);\n      axios.post(\"http://localhost:8080/Login\", newUser).then(resp => {\n        if (resp) {\n          if (resp.data.email === usrLogin && resp.data.password === pwdLogin) {\n            // alert(resp.data.userId)\n            setUser({\n              userId: resp.data.userId,\n              email: resp.data.email\n            });\n            localStorage.setItem(\"user\", JSON.stringify(resp.data)); // alert(user.userId)\n\n            setIsStatusChange(!isStatusChange);\n            setUserDetails(resp.data);\n\n            if (resp.data.role === \"customer\") {\n              History.push(\"/Shop\");\n            } else if (resp.data.role === \"admin\") {\n              History.push(\"/Shop/admin\");\n            } else if (resp.data.role === \"Seller\") {\n              let idSet = {\n                sid: resp.data.userId\n              }; // alert(idSet.sid)\n\n              axios.post(\"http://localhost:8080/findSupplier\", idSet).then(resp => {\n                if (resp) {\n                  setSupplierData(resp.data);\n                  localStorage.setItem(\"supplier\" + resp.data.sid, resp.data);\n                }\n              }).catch(e => {\n                console.log(e);\n              });\n              setIsSupplier(true);\n            }\n          } else {\n            History.push(\"/Login\");\n          }\n        }\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    signUp: e => {\n      e.preventDefault();\n\n      if (pwdLogin === cnfPwdLogin) {\n        if (usrLogin !== null) {\n          axios.post(\"http://localhost:8080/SignUp\", addUser).then(res => {\n            if (res) {\n              History.push('/Shop/products');\n              setUser({ ...user,\n                email: usrLogin\n              });\n            }\n          }).catch(err => {\n            console.log(err);\n          });\n        } else {\n          History.push('/Shop/Login');\n        }\n      } else {\n        alert(\"pwd not match\");\n      }\n    },\n    logout: () => {\n      setUser({});\n      setCartItems([]);\n      localStorage.removeItem(\"user\");\n      setIsStatusChange(!isStatusChange);\n    },\n    user: user,\n    transcationSuccess: (data, cartItem) => {},\n    transcationError: () => {\n      console.log(\"transaction failed\");\n    },\n    transcationCancelled: () => {\n      console.log(\"transaction cancelled\");\n    },\n    onCheckout: e => {\n      History.push(\"/Shop/checkout\");\n    }\n  };\n});","map":{"version":3,"sources":["C:/Users/PC-ASUS/OneDrive/Desktop/freshsop/Freshop/freshop/src/components/useProducts.js"],"names":["useState","useEffect","History","axios","addUser","setAddUser","address","email","mobileNumber","password","role","userName","status","setRole","mobileNum","setMobileNum","userDetails","setUserDetails","pid","setPid","description","setDescription","title","setTitel","catagory","setCatagory","src","setSrc","price","setPrice","useName","setUserName","newUser","setNewUser","setAddress","products","setProducts","filteredProducts","setfilteredProducts","cartItems","setCartItems","search","setSearch","usrLogin","setUsr_Login","pwdLogin","setPwd_Login","cnfPwdLogin","setCnfPwd_Login","licence","setLicence","guestCart","setGuestCart","user","setUser","userId","isStatusChange","setIsStatusChange","orders","setOrders","env","isSupplier","setIsSupplier","adminUser","setAdminUser","currency","supplerAdded","setSupplierAdded","updatableUser","setUpdatableUser","userStatus","setUserStatus","newProduct","setNewProduct","SupplierData","setSupplierData","allSuppliers","setAllSuppliers","lastName","setLastName","client","sandbox","production","get","then","resp","data","catch","e","console","log","newUserData","localStorage","getItem","setData","JSON","parse","newCart","setCart","supplierNewData","setNewSup","sid","ln","supplierFirstName","supplierLastName","undefined","push","filter","product","toLowerCase","includes","put","val","cartItem","productAlreadyInCart","forEach","item","count","setItem","stringify","resultFilter","temp1","temp2","some","id","userDetail","adminUserData","changeLastName","value","changeLicence","changePid","changeTitle","changeDescription","changeCatagory","changePrice","changeSrc","addProduct","newProd","post","alert","finalCheckout","preventDefault","map","cartData","orderId","amount","removeItem","onAddCart","handleSearch","handleChangeSort","sort","updated","a","b","onRemoveCart","update","addSupplier","newSupplier","changeRole","userMobileNumChange","userNameChange","userLoginChange","pwdLoginChange","cnfPwdLoginChange","buy","addressChange","login","idSet","signUp","res","err","logout","transcationSuccess","transcationError","transcationCancelled","onCheckout"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\r\nimport History from './History';\r\nimport axios from 'axios';\r\n\r\n\r\nexport default () => {\r\n    const [addUser, setAddUser] = useState({ address: \"\", email: \"\", mobileNumber: \"\", password: \"\", role: \"\", userName: \"\", status: \"\" });\r\n    const [role, setRole] = useState(\"\");\r\n    const [mobileNum, setMobileNum] = useState(\"\");\r\n    const [userDetails, setUserDetails] = useState({});\r\n    const [pid,setPid] = useState();\r\n    const [description,setDescription] = useState(\"\");\r\n    const [title,setTitel] = useState(\"\");\r\n    const [catagory,setCatagory] = useState(\"\")\r\n    const [src,setSrc] = useState(\"\");\r\n    const [price,setPrice]=useState();\r\n    const [useName, setUserName] = useState(\"\");\r\n    const [newUser, setNewUser] = useState({ email: \"\", password: \"\" });\r\n    const [address, setAddress] = useState(\"\");\r\n    const [products, setProducts] = useState([]);\r\n    const [filteredProducts, setfilteredProducts] = useState([])\r\n    const [cartItems, setCartItems] = useState([])\r\n    const [search, setSearch] = useState(\"\");\r\n    const [usrLogin, setUsr_Login] = useState(\"\");\r\n    const [pwdLogin, setPwd_Login] = useState(\"\");\r\n    const [cnfPwdLogin, setCnfPwd_Login] = useState(\"\");\r\n    const [licence, setLicence] = useState(\"\");\r\n    const [guestCart, setGuestCart] = useState([]);\r\n    const [user, setUser] = useState({ userId: 0, email: \"\" });\r\n    const [isStatusChange, setIsStatusChange] = useState(false);\r\n    const [orders, setOrders] = useState([]);\r\n    const [env] = useState('sandbox');\r\n    const [isSupplier, setIsSupplier] = useState(false);\r\n    const [adminUser, setAdminUser] = useState([]);\r\n    const [currency] = useState('USD');\r\n    const [supplerAdded, setSupplierAdded] = useState(false);\r\n    const [updatableUser, setUpdatableUser] = useState({});\r\n    const [userStatus, setUserStatus] = useState({ status: \"pending\" });\r\n    const [newProduct, setNewProduct] = useState({});\r\n    const [SupplierData, setSupplierData] = useState({});\r\n    const [allSuppliers, setAllSuppliers] = useState([]);\r\n    const [lastName, setLastName] = useState(\"\");\r\n    const [client] = useState({\r\n        sandbox: 'ATKphVPUKrAFnWXr042hYQsynmg9U_UUeudlf1RjYkyKf3rsf5s3IE-H1QZWn8ziKEZzq5WH4TRalZR_',\r\n        production: 'YOUR-PRODUCTION-APP-ID',\r\n    })\r\n\r\n\r\n\r\n\r\n\r\n\r\n    //Products\r\n    useEffect(() => {\r\n\r\n        axios.get(\"http://localhost:8080/Products\").then(\r\n            (resp) => {\r\n                setProducts(resp.data)\r\n                setfilteredProducts(resp.data)\r\n            }\r\n\r\n        ).catch((e) => { console.log(e) })\r\n    }, []);\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        axios.get(\"http://localhost:8080/Roles\").then((resp) => {\r\n            setAdminUser(resp.data);\r\n        }).catch((e) => { console.log(e) })\r\n\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n\r\n        axios.get(\"http://localhost:8080/SuppliedProduct\").then((resp) => {\r\n            if (resp) {\r\n                setAllSuppliers(resp.data);\r\n            }\r\n        }).catch((e) => { console.log(e) });\r\n\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n\r\n        let newUserData = localStorage.getItem(\"user\");\r\n        if (newUserData != null) {\r\n            //alert(\"here\")\r\n            const setData = JSON.parse(newUserData);\r\n            setUser({ userId: setData.userId, email: setData.email })\r\n            setUserDetails({ userId: setData.userId, email: setData.email, userName: setData.userName, role: setData.role, address: setData.address, status: setData.status })\r\n            let newCart = localStorage.getItem(setData.userId + \"cart\");\r\n            if (newCart != null) {\r\n                const setCart = JSON.parse(newCart);\r\n                setCartItems(setCart);\r\n            }\r\n            if (userDetails.role === \"Seller\") {\r\n                let supplierNewData = localStorage.getItem(\"supplier\" + userDetails.userId);\r\n                if (supplierNewData != null) {\r\n                    const setNewSup = JSON.parse(supplierNewData);\r\n                    setSupplierData({ sid: setNewSup.sid, address: setNewSup.address, ln: setNewSup.ln, supplierFirstName: setNewSup.supplierFirstName, supplierLastName: setNewSup.supplierLastName, status: setNewSup.status });\r\n                }\r\n\r\n            }\r\n        }\r\n    }, [isStatusChange])\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        if (userDetails.role === \"Seller\") {\r\n            if (SupplierData.sid != undefined) {\r\n                History.push(\"/Shop/Supplier\")\r\n            } else {\r\n                History.push(\"/Shop/SupplierLogin\")\r\n            }\r\n        }\r\n\r\n    }, [isSupplier, SupplierData])\r\n\r\n    //Search \r\n    useEffect(() => {\r\n        setfilteredProducts(\r\n            [...products].filter(product => {\r\n                return product.title.toLowerCase().includes(search.toLowerCase());\r\n            })\r\n        )\r\n        return () => {\r\n\r\n        };\r\n    }, [search, products])\r\n\r\n    useEffect(() => {\r\n        if (role === \"customer\") {\r\n            setAddUser({ ...addUser, role: role, status: \"varified\" })\r\n        } else if (role === \"admin\") {\r\n            setAddUser({ ...addUser, role: role, status: \"pending\" })\r\n        } else if (role === \"Seller\") {\r\n            setAddUser({ ...addUser, role: role, status: \"pending\" })\r\n        }\r\n\r\n    }, [role])\r\n\r\n    useEffect(() => {\r\n\r\n        if (user.email === null) {\r\n            setGuestCart(cartItems)\r\n        }\r\n    }, [cartItems, user.email])\r\n\r\n    useEffect(() => {\r\n        if (updatableUser.userId !== 0) {\r\n            axios.put(\"http://localhost:8080/UpdateUser\", updatableUser).then((val) => { console.log(val) }).catch((e) => { console.log(e) });\r\n        }\r\n    }, [userStatus])\r\n\r\n    useEffect(() => {\r\n        if (userDetails.role === \"Seller\") {\r\n            History.push(\"/Shop/Supplier\");\r\n        }\r\n    }, [supplerAdded])\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        const cartItem = cartItems;\r\n        // cartItem.map((data)=>alert(data.title))\r\n        let productAlreadyInCart = false;\r\n        if (newProduct.pid != undefined) {\r\n            cartItem.forEach(item => {\r\n                if (item.pid === newProduct.pid) {\r\n                    productAlreadyInCart = true;\r\n                    item.count++;\r\n                }\r\n            })\r\n            if (!productAlreadyInCart) {\r\n                cartItem.push({ ...newProduct, count: 1 })\r\n            }\r\n            setCartItems([...cartItem])\r\n            if (user.userId != 0) {\r\n                localStorage.setItem(user.userId + \"cart\", JSON.stringify(cartItem));\r\n            }\r\n        }\r\n    }, [newProduct])\r\n\r\n\r\n    let resultFilter = (temp1, temp2) => {\r\n        return temp1.filter(temp1 =>\r\n            !temp2.some(\r\n                temp2 => temp1.id === temp2.id\r\n            )\r\n        );\r\n    };\r\n\r\n\r\n    return {\r\n        allSuppliers: allSuppliers,\r\n        filteredProducts: filteredProducts,\r\n        cartItems: cartItems,\r\n        search: search,\r\n        orders: orders,\r\n        env: env,\r\n        currency: currency,\r\n        client: client,\r\n        userDetail: userDetails,\r\n        adminUserData: adminUser,\r\n        SupplierData: SupplierData,\r\n\r\n        changeLastName: (value) => {\r\n            setLastName(value);\r\n        },\r\n        changeLicence: (value) => {\r\n            setLicence(value);\r\n        },\r\n\r\n        changePid:(value)=>{\r\n            setPid(value);\r\n        },\r\n\r\n        changeTitle:(value)=>{\r\n            setTitel(value);\r\n        },\r\n\r\n        changeDescription:(value)=>{\r\n            setDescription(value);\r\n        },\r\n\r\n        changeCatagory:(value)=>{\r\n            setCatagory(value);\r\n        },\r\n\r\n        changePrice:(value)=>{\r\n            setPrice(value);\r\n        },\r\n        \r\n        changeSrc:(value)=>{\r\n            setSrc(value);\r\n        },\r\n\r\n        addProduct:(e)=>{\r\n\r\n            let newProd = {sid:userDetails.userId,pid:pid,title:title,description:description,catagory:catagory,src:src,price:price,status:\"pendingF\"};\r\n            axios.post(\"http://localhost:8080/AddSuppliedProduct\",newProd).then((resp)=>{\r\n                if(resp){\r\n                    alert(\"product added successfully\");\r\n                }\r\n            }).catch((e)=>{console.log(e)})\r\n\r\n        },\r\n\r\n\r\n        finalCheckout:(e)=>{\r\n            e.preventDefault();\r\n            \r\n            cartItems.map((item)=>{\r\n                let cartData = {orderId:\"AX\"+userDetails.userId+\"Ab\",title:item.title,amount:item.price,price:item.price};\r\n                axios.post(\"http://localhost:8080/AddOrder\",cartData).then((resp)=>{\r\n                    if(resp){\r\n                        alert(\"order successful\");\r\n                        localStorage.removeItem(\"supplier\" + userDetails.userId);\r\n                    }\r\n                })\r\n\r\n            })\r\n           \r\n        },\r\n\r\n\r\n        onAddCart: (product) => {\r\n\r\n            setNewProduct(product);\r\n        },\r\n        handleSearch: (value) => {\r\n            setSearch(value);\r\n        },\r\n\r\n        handleChangeSort: (sort) => {\r\n            if (sort !== '') {\r\n                const updated = [...products].sort((a, b) => {\r\n                    return (sort === \"lowest\") ? (a.price > b.price ? 1 : -1) : (a.price < b.price ? 1 : -1);\r\n                });\r\n                setfilteredProducts(updated);\r\n            }\r\n            else {\r\n                const updated = [...products].sort((a, b) => { return (a.id < b.id ? 1 : -1) });\r\n                setfilteredProducts(updated);\r\n            }\r\n        },\r\n\r\n        onRemoveCart: (removeItem) => {\r\n            const update = [...cartItems].filter(item => {\r\n                if (item.pid === removeItem.pid && removeItem.count <= 1)\r\n\r\n                    return false;\r\n                else {\r\n                    if (item.pid === removeItem.pid && removeItem.count > 1)\r\n                        item.count--;\r\n                    return true;\r\n                }\r\n            });\r\n            setCartItems(update);\r\n\r\n        },\r\n\r\n        addSupplier: (e) => {\r\n            e.preventDefault();\r\n            let newSupplier = { sid: userDetails.userId, address: userDetails.address, ln: licence, status: \"pending\", supplierFirstName: userDetails.userName, supplierLastName: lastName };\r\n            axios.post(\"http://localhost:8080/AddSupplier\", newSupplier).then((resp) => {\r\n                if (resp) {\r\n                    setSupplierAdded(true);\r\n                }\r\n            }).catch((e) => { console.log(e) });\r\n        },\r\n\r\n        userStatus: (value, item) => {\r\n\r\n            // alert(item.userName)\r\n            setUserStatus({ status: value })\r\n            setUpdatableUser(item)\r\n        },\r\n\r\n\r\n        changeRole: (value) => {\r\n\r\n            setRole(value);\r\n        },\r\n\r\n\r\n        userMobileNumChange: (value) => {\r\n            setMobileNum(value);\r\n            setAddUser({ ...addUser, mobileNumber: value })\r\n        },\r\n\r\n        userNameChange: (value) => {\r\n            setUserName(value);\r\n            setAddUser({ ...addUser, userName: value })\r\n        },\r\n\r\n        userLoginChange: (value) => {\r\n            setUsr_Login(value);\r\n            setNewUser({ ...newUser, email: value })\r\n            setAddUser({ ...addUser, email: value })\r\n        },\r\n\r\n        pwdLoginChange: (value) => {\r\n            setPwd_Login(value);\r\n            setNewUser({ ...newUser, password: value })\r\n            setAddUser({ ...addUser, password: value })\r\n        },\r\n\r\n        cnfPwdLoginChange: (value) => {\r\n            setCnfPwd_Login(value)\r\n        },\r\n        buy: (value) => {\r\n            History.push('/Shop/' + value);\r\n        },\r\n        addressChange: (value) => {\r\n            setAddress(value);\r\n            setAddUser({ ...addUser, address: value })\r\n        },\r\n        login: (e) => {\r\n            e.preventDefault();\r\n            console.log(newUser)\r\n            axios.post(\"http://localhost:8080/Login\", newUser).then((resp) => {\r\n\r\n                if (resp) {\r\n\r\n                    if (resp.data.email === usrLogin && resp.data.password === pwdLogin) {\r\n                        // alert(resp.data.userId)\r\n                        setUser({ userId: resp.data.userId, email: resp.data.email })\r\n                        localStorage.setItem(\"user\", JSON.stringify(resp.data));\r\n                        // alert(user.userId)\r\n                        setIsStatusChange(!isStatusChange);\r\n                        setUserDetails(resp.data);\r\n                        if (resp.data.role === \"customer\") {\r\n                            History.push(\"/Shop\")\r\n                        }\r\n                        else if (resp.data.role === \"admin\") {\r\n                            History.push(\"/Shop/admin\")\r\n                        } else if (resp.data.role === \"Seller\") {\r\n\r\n\r\n                            let idSet = { sid: resp.data.userId };\r\n                            // alert(idSet.sid)\r\n                            axios.post(\"http://localhost:8080/findSupplier\", idSet).then((resp) => {\r\n                                if (resp) {\r\n                                    setSupplierData(resp.data);\r\n                                    localStorage.setItem(\"supplier\" + resp.data.sid, resp.data);\r\n                                }\r\n                            }).catch((e) => { console.log(e) })\r\n\r\n                            setIsSupplier(true);\r\n                        }\r\n\r\n                    } else {\r\n                        History.push(\"/Login\")\r\n                    }\r\n                }\r\n            }).catch((e) => { console.log(e) })\r\n        },\r\n\r\n        signUp: (e) => {\r\n            e.preventDefault();\r\n            if (pwdLogin === cnfPwdLogin) {\r\n                if (usrLogin !== null) {\r\n                    axios.post(\"http://localhost:8080/SignUp\", addUser).then((res) => {\r\n                        if (res) {\r\n                            History.push('/Shop/products')\r\n                            setUser({ ...user, email: usrLogin })\r\n                        }\r\n                    })\r\n                        .catch((err) => {\r\n                            console.log(err)\r\n                        })\r\n                }\r\n                else {\r\n                    History.push('/Shop/Login')\r\n                }\r\n            }\r\n            else {\r\n                alert(\"pwd not match\");\r\n            }\r\n        },\r\n\r\n        logout: () => {\r\n            setUser({});\r\n            setCartItems([]);\r\n            localStorage.removeItem(\"user\");\r\n            setIsStatusChange(!isStatusChange);\r\n        },\r\n        user: user,\r\n        transcationSuccess: (data, cartItem) => {\r\n\r\n        },\r\n        transcationError: () => {\r\n            console.log(\"transaction failed\");\r\n        },\r\n        transcationCancelled: () => {\r\n            console.log(\"transaction cancelled\")\r\n        },\r\n        onCheckout: (e) => {\r\n            History.push(\"/Shop/checkout\");\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}